clear all; close all; clear classes; clc;

%% Palik II's H2O, p.1067
wvlen = 1e6 * [10 9.5057 8.9928 8.4890 8.0000 7.4963 6.9979 6.5020 5.9988 5.4945 5.0000 4.4984 4.0000 3.4990 2.9994 2.5006 2.0000 1.4997 1.0000];
wvlen = [wvlen 1e5 * [9.5057 8.9928 8.4890 8.0000 7.4963 6.9979 6.5020 5.9988 5.4945 5.0000 4.4984 4.0000 3.4990 2.9994 2.5006 2.0000 1.4997 1.0000]];
wvlen = [wvlen 1e4 * [9.4967 9.0009 8.4962 8.0000 7.5019 6.9979 6.4977 6.0024 5.5006 5.0000 4.5005 4.0000]];

n = [8.849 8.849 8.849 8.849 8.849 8.849 8.849 8.849 8.849 8.849 8.849 8.849 8.849 8.849 8.849 8.849 8.848 8.848 8.848 8.848 8.847 8.847 8.847 8.847 8.847 8.847 8.846 8.846 8.845 8.844 8.843 8.841 8.838 8.833 8.824 8.804 8.743 8.732 8.720 8.705 8.689 8.670 8.648 8.620 8.587 8.546 8.497 8.436 8.353];

k = 1e-3 * [6.931 7.291 7.688 8.124 8.626 9.200 9.858];
k = [k 1e-2 * [1.061 1.148 1.250 1.373 1.523 1.713 1.953 2.274 2.721 3.395 4.506 6.727 7.076 7.461 7.885 8.391 8.929 9.567]];
k = [k 1e-1 * [1.030 1.114 1.213 1.333 1.478 1.659 1.891 2.202 2.634 3.277 4.337 6.409 6.730 7.083 7.476 7.914 8.406 8.960 9.589]];
k = [k [1.031 1.115 1.212 1.327 1.463]];


%% Palik II's H2O, p.1068
wvlen = [wvlen 1e4 * [3.5002 3.0003 2.5000 2.0000 1.4999 1.0000]];
wvlen = [wvlen 1e3 * [9.4967 9.0009 8.5034 8.0000 7.5019 6.9979 6.4977 6.0024 5.5006 5.0000 4.5005 4.0000 3.5002 3.0003 2.5000 2.0000 1.4999 1.0000]];
wvlen = [wvlen 1e2 * [7.4963 5.5991 4.6019 3.5971 2.7988 2.3015 1.7989 1.3002]];
wvlen = [wvlen 1e1 * [9.5969 8.5911 7.6046 6.6050 5.5991 4.7985 4.2955 3.8023 3.3036 2.7988 2.3015 1.9908 1.9635 1.9410 1.9142 1.8879 1.8664]];

n = [n [8.238 8.075 7.831 7.456 6.867 5.879 5.747 5.607 5.459 5.305 5.146 4.980 4.811 4.631 4.442 4.248 4.045 3.829 3.607 3.375 3.134 2.882 2.629 2.399 2.290 2.220 2.166 2.099 2.045 2.001 1.956 1.920 1.891 1.860 1.806 1.729 1.619 1.520 1.481 1.481 1.512 1.546 1.516 1.467 1.460 1.454 1.446 1.436 1.428]];

k = [k [1.627 1.824 2.064 2.338 2.630 2.830 2.835 2.832 2.826 2.811 2.792 2.766 2.727 2.685 2.625 2.551 2.460 2.360 2.228 2.079 1.891 1.670 1.393 1.042]];
k = [k 1e-1 * [8.725 7.359 6.727 5.967 5.355 4.964 4.506 4.186 4.485 4.773 5.079 5.233 5.162 4.579 3.880 3.190 2.830 2.991 3.629 3.952 4.016 4.072 4.110 4.157 4.196]];

%% Palik II's H2O, p.1069
wvlen = [wvlen 1e1 * [1.8406 1.8155 1.7905 1.7662 1.7419 1.7141 1.6903 1.6633 1.6407 1.6145 1.5886 1.5667 1.5418 1.5135 1.4894 1.4656 1.4388 1.4158 1.3900 1.3646 1.3398 1.3153 1.2912 1.2647 1.2389 1.2162 1.1912 1.1641 1.1403 1.1143 1.0890 1.0642 1.0399 1.0139]];
wvlen = [wvlen [9.9108 9.6618 9.3985 9.1408 8.8889 8.6505 8.3963 8.1500 7.9051 7.6570 7.3964 7.1429 6.9013 6.6534 6.3980]];

n = [n [1.418 1.407 1.396 1.386 1.375 1.361 1.350 1.335 1.323 1.309 1.295 1.283 1.268 1.254 1.239 1.226 1.209 1.196 1.179 1.162 1.146 1.131 1.117 1.105 1.092 1.087 1.087 1.096 1.105 1.119 1.134 1.150 1.167 1.184 1.199 1.211 1.223 1.233 1.241 1.249 1.257 1.264 1.270 1.277 1.284 1.291 1.298 1.309 1.325]];

k = [k 1e-1 * [4.234 4.254 4.264 4.283 4.293 4.293 4.293 4.283 4.264 4.244 4.205 4.176 4.119 4.053 3.998 3.934 3.844 3.757 3.646 3.514 3.363 3.183 2.977 2.740 2.476 2.177 1.865 1.570 1.321 1.083]];
k = [k 1e-2 * [8.970 7.359 6.191 5.380 4.929 4.600 4.333 4.110 3.916 3.748 3.604 3.490 3.395 3.302 3.242 3.205 3.220 3.450 4.485]];


%% Palik II's H2O, p.1070
wvlen = [wvlen [6.1958 5.9559 5.7013 5.4437 5.2002 4.9554 4.6992 4.4464 4.1982 3.9541 3.6982 3.4518 3.1990 2.9851 2.9377 2.8977 2.8580 2.8185 2.7801 2.7412 2.7042 2.6667 2.6302 2.5940 2.5648 2.5530 2.5006 2.4492 2.3987 2.3496 2.3015 2.2492 2.1978 2.1478 2.0991 2.0513 2.0000 1.9497 1.9011 1.8491 1.7989 1.7498 1.6984 1.6483 1.5995 1.5487 1.4997 1.4489 1.3996]];

n = [n [1.342 1.232 1.257 1.282 1.298 1.307 1.311 1.315 1.324 1.337 1.357 1.393 1.462 1.334 1.264 1.196 1.145 1.125 1.131 1.142 1.175 1.199 1.218 1.232 1.240 1.243 1.253 1.261 1.268 1.273 1.278 1.282 1.286 1.289 1.292 1.294 1.297 1.298 1.299 1.301 1.303 1.305 1.307 1.308 1.310 1.311 1.312 1.313 1.314]];

k = [k 1e-2 * [8.786 8.646 2.031 1.078 1.011 1.312 1.570 1.140]];
k = [k 1e-3 * [6.883 4.157 3.596]];
k = [k 1e-2 * [1.321 9.243]];
k = [k 1e-1 * [2.721 2.804 2.581 2.060 1.422]];
k = [k 1e-2 * [9.285 4.622 1.640]];
k = [k 1e-3 * [7.325 4.016 2.476 2.266 2.142 1.900 1.348]];
k = [k 1e-4 * [9.095 6.365 4.686 3.739 3.379 3.705 4.643 6.742]];
k = [k 1e-3 * [1.101 1.848 1.161]];
k = [k 1e-4 * [1.861 1.359 1.000]];
k = [k 1e-5 * [7.743 7.591 9.347]];
k = [k 1e-4 * [1.348 2.248 3.637 1.530]];

%% Palik II's H2O, p.1071
wvlen = [wvlen [1.3490 1.3002 1.2503 1.1995 1.1507 1.0990 1.0495 1.0000]];
wvlen = [wvlen 1e-1 * [9.7466 9.5057 9.2507 8.9928 8.7489 8.4890 8.2440 8.0000 7.7459 7.4963 7.2464 6.9979 6.7431 6.5020 6.2500 5.9988 5.7537 5.4945 5.2493 5.0000 4.7529 4.4984 4.2463 4.0000 3.7495 3.4990 3.2510 2.9994 2.7480 2.5006 2.2492 2.0991 2.0000 1.9011 1.7989 1.7419 1.6984 1.6595 1.6218 1.5813 1.5418]];

n = [n [1.315 1.316 1.317 1.318 1.319 1.320 1.321 1.322 1.322 1.323 1.323 1.324 1.324 1.325 1.325 1.326 1.327 1.327 1.328 1.329 1.330 1.331 1.332 1.333 1.334 1.336 1.338 1.339 1.342 1.344 1.347 1.350 1.354 1.358 1.364 1.371 1.381 1.395 1.416 1.435 1.452 1.475 1.513 1.549 1.606 1.647 1.653 1.641 1.597]];

k = [k 1e-5 * [4.047 1.400 1.100 1.199]];
k = [k 1e-6 * [9.306 1.708 1.419 3.000 3.480 2.932 1.060]];
k = [k 1e-7 * [4.862 3.907 2.929 1.819 1.250 1.478 1.559]];
k = [k 1e-8 * [9.137 3.348 2.177 1.674 1.472]];
k = [k 1e-9 * [9.634 3.844 2.442 1.640]];
k = [k 1e-10 * [9.243 7.011 8.087]];
k = [k 1e-9 * [1.169 1.580 2.031 2.528 3.082 4.148 6.292 9.307]];
k = [k 1e-8 * [1.158 3.844]];
k = [k 1e-7 * [1.101 3.622]];
k = [k 1e-5 * [5.995]];
k = [k 1e-3 * [1.182 3.998]];
k = [k 1e-2 * [7.241]];
k = [k 1e-1 * [1.351 2.022 2.581]];


%% Palik II's H2O, p.1072
wvlen = [wvlen 1e-1 * [1.4997 1.4588 1.4190 1.3805 1.3398 1.3002 1.2590 1.2189 1.1804 1.1403 1.0990 1.0592 1.0209]];
wvlen = [wvlen 1e-2 * [9.7943 9.3985 8.9928 8.5911 8.2034 7.8003 7.3964 6.9979 6.6050 6.1958 5.7937 5.3937 5.0000 4.6019 4.1982 3.8023 3.3967 2.9994 2.6001 2.1978 1.7989 1.3996 1.1995 1.0000]];

n = [n [1.521 1.469 1.462 1.496 1.586 1.634 1.606 1.570 1.553 1.543 1.529 1.516 1.493 1.456 1.388 1.303 1.215 1.141 1.088 1.050 0.982 0.904 0.841 0.832 0.835 0.821 0.797 0.802 0.820 0.842 0.867 0.891 0.914 0.935 0.953 0.961 0.968]];

k = [k 1e-1 * [2.772 2.409 1.927 1.422 1.489 2.392 3.220 3.490 3.705 3.988 4.303 4.707 5.185 5.752 6.292 6.528 6.573 6.292 5.981 5.805 5.791 5.355 4.558 3.739 3.310 2.998 2.414 1.798 1.303]];
k = [k 1e-2 * [9.074 6.064 3.818 2.227 1.164]];
k = [k 1e-3 * [5.174 3.146 1.745]];


%% Convert the wavelengths to the photon energies.
eV = PhysC.h * PhysC.c0 * 1e6 ./ wvlen;

% %% Reverse the data order.
% eV = eV(end:-1:1);
% n = n(end:-1:1);
% k = k(end:-1:1);
% wvlen = wvlen(end:-1:1);

%% Calculate the permittivity from n and k following the exp(+i w t) time dependence.
eps = (n - 1i*k).^2;

%% Plot n and k.  Compare with Fig. 1 on p.1066 of Palik II.
nk_wvlen = 1;
eps_eV = 2;
eps_wvlen = 3;
abseps_eV = 4;
plotstyle = nk_wvlen;
switch plotstyle
    case nk_wvlen  % plot n and k
        loglog(wvlen, n, '-o', wvlen, k, '-o')
        %plot(wvlen, n, wvlen, k)
        legend('n', 'k', 'Location', 'SouthEast');
        xlabel 'wavelength (µm)'
%         axis([1e0 2e0 1e-6 1e1])
    case eps_eV  % plot real(eps) and -imag(eps)
        plot(eV, real(eps), 'o-', eV, -imag(eps), 'o-')
        legend('\epsilon_1', '\epsilon_2', 'Location', 'SouthEast');
        xlabel 'Photon Energy (eV)'
        %axis([0.5 6.5 -7 7]);
    case eps_wvlen
        plot(wvlen, real(eps), 'o-', wvlen, -imag(eps), 'o-')
        legend('\epsilon_1', '\epsilon_2', 'Location', 'SouthEast');
        xlabel 'wavelength (µm)'
        %axis([0 1e2 -1e1 1e1])
    case abseps_eV  % plot real(eps) and -imag(eps)
        loglog(eV, abs(real(eps)), 'o-', eV, -imag(eps), 'o-')
        legend('\epsilon_1', '\epsilon_2', 'Location', 'SouthEast');
        xlabel 'Photon Energy (eV)'
end
title(mfilename)

%% Save data.
% save(mfilename, 'eV', 'n', 'k');
